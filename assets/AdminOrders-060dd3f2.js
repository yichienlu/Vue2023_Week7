import{P as w}from"./PaginationComponent-4120bfa5.js";import{g as T,p as h,b as f,m as g,_ as k,o as s,c as d,d as t,t as n,j as _,F as c,h as b,k as v,q as C,M as D,r as $,e as y,n as P}from"./index-10e837fa.js";const{VITE_URL:m,VITE_PATH:p}={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"yclu",BASE_URL:"/Vue2023_Week7/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},u=T("adminOrdersStore",{state:()=>({tempOrder:{},orders:[],pagination:{}}),actions:{getAdminOrders(e=1){h.get(`${m}/api/${p}/admin/orders?page=${e}`).then(l=>{this.pagination=l.data.pagination,this.orders=l.data.orders}).catch(l=>{console.log(l)})},editOrder(e,l=null){h.put(`${m}/api/${p}/admin/order/${e.id}`,{data:e}).then(i=>{console.log(i.data),l&&l.hide(),this.getAdminOrders()}).catch(i=>{console.dir(i)})},deleteOrder(e){h.delete(`${m}/api/${p}/admin/order/${e}`).then(l=>{console.log(l.data),this.getAdminOrders()}).catch(l=>{console.dir(l)})},selectTempOrder(e){this.tempOrder=e}}}),L={data(){return{}},props:["adminOrderModal"],methods:{...f(u,["addOrder","editOrder"])},computed:{...g(u,["tempOrder"])}},U={class:"modal-dialog modal-xl",role:"document"},N={class:"modal-content border-0"},R=t("div",{class:"modal-header bg-dark text-white"},[t("h5",{class:"modal-title",id:"exampleModalLabel"},[t("span",null,"訂單細節")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),B={class:"modal-body"},I={class:"row"},q={class:"col-md-4"},j=t("h3",null,"用戶資料",-1),F={class:"table"},H={key:0},J=t("th",{style:{width:"100px"}},"姓名",-1),z=t("th",null,"Email",-1),W=t("th",null,"電話",-1),G=t("th",null,"地址",-1),K={class:"col-md-8"},Q=t("h3",null,"訂單細節",-1),X={class:"table"},Y=t("th",{style:{width:"100px"}},"訂單編號",-1),Z=t("th",null,"下單時間",-1),x=t("th",null,"付款時間",-1),tt={key:0},et={key:1},st=t("th",null,"付款狀態",-1),dt={key:0,class:"text-success"},nt={key:1,class:"text-muted"},lt=t("th",null,"總金額",-1),ot=t("h3",null,"選購商品",-1),at={class:"table"},rt=t("thead",null,[t("tr")],-1),it={class:"text-end"},ct={class:"d-flex justify-content-end"},ut={class:"form-check"},ht={class:"form-check-label",for:"flexCheckDefault"},mt={key:0},pt={key:1},_t={class:"modal-footer"},bt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Ot(e,l,i,M,O,A){return s(),d("div",U,[t("div",N,[R,t("div",B,[t("div",I,[t("div",q,[j,t("table",F,[e.tempOrder.user?(s(),d("tbody",H,[t("tr",null,[J,t("td",null,n(e.tempOrder.user.name),1)]),t("tr",null,[z,t("td",null,n(e.tempOrder.user.email),1)]),t("tr",null,[W,t("td",null,n(e.tempOrder.user.tel),1)]),t("tr",null,[G,t("td",null,n(e.tempOrder.user.address),1)])])):_("",!0)])]),t("div",K,[Q,t("table",X,[t("tbody",null,[t("tr",null,[Y,t("td",null,n(e.tempOrder.id),1)]),t("tr",null,[Z,t("td",null,n(e.$filters.date(e.tempOrder.create_at)),1)]),t("tr",null,[x,t("td",null,[e.tempOrder.paid_date?(s(),d("span",tt,n(e.$filters.date(e.tempOrder.paid_date)),1)):(s(),d("span",et,"時間不正確"))])]),t("tr",null,[st,t("td",null,[e.tempOrder.is_paid?(s(),d("strong",dt,"已付款")):(s(),d("span",nt,"尚未付款"))])]),t("tr",null,[lt,t("td",null," $ "+n(e.$filters.currency(e.tempOrder.total)),1)])])]),ot,t("table",at,[rt,t("tbody",null,[(s(!0),d(c,null,b(e.tempOrder.products,a=>(s(),d("tr",{key:a.id},[t("th",null,n(a.product.title),1),t("td",null,n(a.qty)+" / "+n(a.product.unit),1),t("td",it," $ "+n(e.$filters.currency(a.final_total)),1)]))),128))])]),t("div",ct,[t("div",ut,[v(t("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckDefault","onUpdate:modelValue":l[0]||(l[0]=a=>e.tempOrder.is_paid=a)},null,512),[[C,e.tempOrder.is_paid]]),t("label",ht,[e.tempOrder.is_paid?(s(),d("span",mt,"已付款")):(s(),d("span",pt,"未付款"))])])])])])]),t("div",_t,[bt,t("button",{type:"button",class:"btn btn-primary",onClick:l[1]||(l[1]=a=>e.editOrder(e.tempOrder,i.adminOrderModal))}," 確認修改 ")])])])}const $t=k(L,[["render",Ot]]),yt={data(){return{adminOrderModal:null}},components:{Pagination:w,AdminOrderModal:$t},computed:{...g(u,["tempOrder","orders","pagination"])},methods:{...f(u,["getAdminOrders","editOrder","selectTempOrder","deleteOrder"])},mounted(){this.getAdminOrders(),this.adminOrderModal=new D("#adminOrderModal")}},ft={class:"container"},gt={class:"table mt-4"},kt=t("thead",null,[t("tr",null,[t("th",null,"購買時間"),t("th",null,"Email"),t("th",null,"購買款項"),t("th",null,"應付金額"),t("th",null,"是否付款"),t("th",null,"編輯")])],-1),vt=["textContent"],Ct={class:"list-unstyled"},Mt={class:"text-right"},At={class:"form-check form-switch"},St=["id","onUpdate:modelValue","onChange"],Vt=["for"],Et={key:0},wt={key:1},Tt={class:"btn-group"},Dt=["onClick"],Pt=["onClick"],Lt={id:"adminOrderModal",ref:"adminOrderModal",class:"modal fade",tabindex:"-1","aria-labelledby":"orderModalLabel","aria-hidden":"true"};function Ut(e,l,i,M,O,A){const a=$("pagination"),S=$("admin-order-modal");return s(),d(c,null,[t("div",ft,[t("table",gt,[kt,t("tbody",null,[(s(!0),d(c,null,b(e.orders,(o,V)=>(s(),d(c,{key:V},[e.orders.length?(s(),d("tr",{key:0,class:P({"text-secondary":!o.is_paid})},[t("td",null,n(e.$filters.date(o.create_at)),1),t("td",null,[o.user?(s(),d("span",{key:0,textContent:n(o.user.email)},null,8,vt)):_("",!0)]),t("td",null,[t("ul",Ct,[(s(!0),d(c,null,b(o.products,(r,E)=>(s(),d("li",{key:E},n(r.product.title)+" 數量："+n(r.qty)+" "+n(r.product.unit),1))),128))])]),t("td",Mt,"$ "+n(e.$filters.currency(o.total)),1),t("td",null,[t("div",At,[v(t("input",{class:"form-check-input",type:"checkbox",id:`paidSwitch${o.id}`,"onUpdate:modelValue":r=>o.is_paid=r,onChange:r=>e.editOrder(o)},null,40,St),[[C,o.is_paid]]),t("label",{class:"form-check-label",for:`paidSwitch${o.id}`},[o.is_paid?(s(),d("span",Et,"已付款")):(s(),d("span",wt,"未付款"))],8,Vt)])]),t("td",null,[t("div",Tt,[t("button",{class:"btn btn-outline-primary btn-sm",type:"button","data-bs-toggle":"modal","data-bs-target":"#adminOrderModal",onClick:r=>e.selectTempOrder(JSON.parse(JSON.stringify(o)))}," 檢視 ",8,Dt),t("button",{class:"btn btn-outline-danger btn-sm",type:"button",onClick:r=>e.deleteOrder(o.id)}," 刪除 ",8,Pt)])])],2)):_("",!0)],64))),128))])]),y(a,{pages:e.pagination,onChangePage:e.getAdminOrders},null,8,["pages","onChangePage"])]),t("div",Lt,[y(S,{"admin-order-modal":O.adminOrderModal},null,8,["admin-order-modal"])],512)],64)}const Bt=k(yt,[["render",Ut]]);export{Bt as default};
