import{c as v}from"./cartStore-392ffd8a.js";import{_ as $,m as I,b as U,r as u,o as d,c as r,d as e,i as E,F as f,h as g,t as n,j as S,k as _,v as y,f as b,e as a,w as V,l as w,n as m}from"./index-10e837fa.js";const{VITE_URL:T,VITE_PATH:N}={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"yclu",BASE_URL:"/Vue2023_Week7/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},q={data(){return{coupon_code:""}},computed:{...I(v,["cart","form","loadingItem"])},methods:{...U(v,["getCarts","updateCartItem","deleteCartItem","clearCart","createOrder"]),addCouponCode(){this.$http.post(`${T}/api/${N}/coupon`,{data:{code:this.coupon_code}}).then(t=>{console.log(t.data),this.getCarts()}).catch(t=>{console.log(t)})},isPhone(t){return/^(09)[0-9]{8}$/.test(t)?!0:"需要正確的電話號碼"}},mounted(){this.getCarts()}},D={class:"container"},P={class:"text-end"},R={class:"table align-middle"},A=e("thead",null,[e("tr",null,[e("th"),e("th",null,"品名"),e("th",{style:{width:"150px"}},"數量/單位"),e("th",null,"單價")])],-1),B=["onClick","disabled"],L={class:"input-group input-group-sm"},M={class:"input-group mb-3"},O=["onUpdate:modelValue","onChange","disabled"],j=["value"],F={class:"input-group-text",id:"basic-addon2"},H={class:"text-end"},z={class:"text-success"},W=e("td",{colspan:"3",class:"text-end"},"總計",-1),G={class:"text-end"},J={colspan:"3",class:"text-end text-success"},K={key:0},Q={class:"text-end text-success"},X={class:"input-group mb-3 input-group-sm"},Y={class:"input-group-append"},Z={key:1,class:"text-center"},x={class:"my-5 row justify-content-center"},ee={class:"mb-3"},te=e("label",{for:"email",class:"form-label"},"Email",-1),se={class:"mb-3"},oe=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),le={class:"mb-3"},ae=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),ne={class:"mb-3"},de=e("label",{for:"address",class:"form-label"},"收件人地址",-1),re={class:"mb-3"},ie=e("label",{for:"message",class:"form-label"},"留言",-1),ce={class:"text-end"},ue=["disabled"];function me(t,o,pe,fe,h,p){const C=u("router-link"),i=u("v-field"),c=u("error-message"),k=u("v-form");return d(),r("div",D,[e("div",P,[e("button",{class:"btn btn-outline-danger",type:"button",onClick:o[0]||(o[0]=E(s=>t.clearCart(),["prevent"]))},"清空購物車")]),t.cart.total?(d(),r(f,{key:0},[e("table",R,[A,e("tbody",null,[(d(!0),r(f,null,g(t.cart.carts,s=>(d(),r("tr",{key:s.id},[e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:l=>t.deleteCartItem(s),disabled:s.id===t.loadingItem}," x ",8,B)]),e("td",null,n(s.product.title)+" ",1),e("td",null,[e("div",L,[e("div",M,[_(e("select",{name:"",id:"",class:"form-control","onUpdate:modelValue":l=>s.qty=l,onChange:l=>t.updateCartItem(s),disabled:s.id===t.loadingItem},[(d(),r(f,null,g(20,l=>e("option",{value:l,key:`${l}unit`},n(l),9,j)),64))],40,O),[[w,s.qty]]),e("span",F,n(s.product.unit),1)])])]),e("td",H,[b(" $ "+n(t.$filters.currency(s.total))+" ",1),e("small",z,"折扣價：$ "+n(t.$filters.currency(s.final_total)),1)])]))),128))]),e("tfoot",null,[e("tr",null,[W,e("td",G,"$ "+n(t.$filters.currency(t.cart.total)),1)]),e("tr",null,[e("td",J,[t.cart.carts[0].coupon?(d(),r("div",K," 已套用折價券 "+n(t.cart.carts[0].coupon.title),1)):S("",!0)]),e("td",Q," 折扣價：$ "+n(t.$filters.currency(t.cart.final_total)),1)])])]),e("div",X,[_(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[1]||(o[1]=s=>h.coupon_code=s),placeholder:"請輸入優惠碼"},null,512),[[y,h.coupon_code]]),e("div",Y,[e("button",{class:"btn btn-outline-secondary",type:"button",onClick:o[2]||(o[2]=(...s)=>p.addCouponCode&&p.addCouponCode(...s))}," 套用優惠碼 ")])])],64)):(d(),r("div",Z,[b("購物車空空如也，"),a(C,{to:"/products",class:""},{default:V(()=>[b("去購物")]),_:1})])),e("div",x,[a(k,{ref:"form",class:"col-md-6",onSubmit:t.createOrder},{default:V(({errors:s})=>[e("div",ee,[te,a(i,{id:"email",name:"email",type:"email",class:m(["form-control",{"is-invalid":s.email}]),placeholder:"請輸入 Email",rules:"required|email",modelValue:t.form.user.email,"onUpdate:modelValue":o[3]||(o[3]=l=>t.form.user.email=l)},null,8,["class","modelValue"]),a(c,{name:"email",class:"invalid-feedback"})]),e("div",se,[oe,a(i,{id:"name",name:"姓名",type:"text",class:m(["form-control",{"is-invalid":s.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:t.form.user.name,"onUpdate:modelValue":o[4]||(o[4]=l=>t.form.user.name=l)},null,8,["class","modelValue"]),a(c,{name:"姓名",class:"invalid-feedback"})]),e("div",le,[ae,a(i,{id:"tel",name:"電話",type:"tel",class:m(["form-control",{"is-invalid":s.電話}]),placeholder:"請輸入電話",rules:p.isPhone,modelValue:t.form.user.tel,"onUpdate:modelValue":o[5]||(o[5]=l=>t.form.user.tel=l)},null,8,["class","rules","modelValue"]),a(c,{name:"電話",class:"invalid-feedback"})]),e("div",ne,[de,a(i,{id:"address",name:"地址",type:"text",class:m(["form-control",{"is-invalid":s.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:t.form.user.address,"onUpdate:modelValue":o[6]||(o[6]=l=>t.form.user.address=l)},null,8,["class","modelValue"]),a(c,{name:"地址",class:"invalid-feedback"})]),e("div",re,[ie,_(e("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":o[7]||(o[7]=l=>t.form.message=l)},null,512),[[y,t.form.message]])]),e("div",ce,[e("button",{type:"submit",class:"btn btn-danger",disabled:!t.cart.total},"送出訂單",8,ue)])]),_:1},8,["onSubmit"])])])}const he=$(q,[["render",me]]);export{he as default};
